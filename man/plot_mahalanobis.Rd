% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_mahalanobis.R
\name{plot_mahalanobis}
\alias{plot_mahalanobis}
\title{Mahalanobis outlier detection plot}
\usage{
plot_mahalanobis(x, idvar = NULL, elbow_threshold = NULL, verbose = TRUE, ...)
}
\arguments{
\item{x}{A \code{check_outliers} object created with \code{method = "mahalanobis"}.}

\item{idvar}{Optional character string giving the name of a variable in the original
data to use as point labels (e.g., participant ID). If \code{NULL}, row names are used.}

\item{elbow_threshold}{Optional scalar setting the minimum jump in Mahalanobis
distance (between adjacent sorted observations) to be considered an elbow. By
default, the 95th percentile of all such jumps is used. Higher values yield more
conservative outlier detection.}

\item{verbose}{Logical. If \code{TRUE} (default), prints a summary list of outlier IDs.}

\item{...}{Additional arguments passed to plotting layers.}
}
\value{
A \code{ggplot2} object displaying the Mahalanobis outlier plot.
When \code{verbose = TRUE}, also prints a list with the IDs of \code{chi_outliers} and \code{elbow_outliers}.
}
\description{
Produces a scree-style Mahalanobis distance plot that highlights two types of
multivariate outliers. Observations exceeding the chi-squared cutoff are shown
in warm colors, while observations following large jumps ("elbows") in the sorted
Mahalanobis distances are shown in cool colors. Elbow outliers are defined based
on sudden increases in distance, analogous to inflection points in scree plots.
}
\details{
This plot method is automatically called when plotting the result of
\code{\link[performance:check_outliers]{performance::check_outliers()}} with \code{method = "mahalanobis"}.
}
\examples{
## Simulate a small dataset and illustrate the use of the function
set.seed(123)
x <- matrix(rnorm(200 * 5), ncol = 5)
colnames(x) <- paste0("Var", seq_len(ncol(x)))
df <- as.data.frame(x)
df$ID <- paste0("Obs", seq_len(nrow(df)))
x <- performance::check_outliers(df, threshold = 15)
plot(x, idvar = "ID", elbow_threshold = 3)
}
\references{
This implementation was inspired by a visualization approach developed by
Prof. Marina Doucerain (Université du Québec à Montréal).
}
